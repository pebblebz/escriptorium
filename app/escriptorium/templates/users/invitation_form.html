{% extends "base.html" %}
{% load i18n bootstrap %}

{% block body %}
<h1>{% trans "Invite Users" %}</h1>

<div class="row container">
  <div class="col-md-8 col-md-offset-2">

    <!-- Toggle buttons: reload with ?mode=... so only one form is instantiated -->
    <div class="btn-group my-3" role="group" aria-label="{% trans 'Invite mode' %}">
      <a href="?mode=single"
         class="btn {% if active_mode == 'single' %}btn-primary{% else %}btn-outline-primary{% endif %}">
        {% trans "Single" %}
      </a>
      <a href="?mode=bulk"
         class="btn {% if active_mode == 'bulk' %}btn-primary{% else %}btn-outline-primary{% endif %}">
        {% trans "Bulk" %}
      </a>
    </div>

    {# single invite #}
    {% if active_mode == 'single' %}
      <form method="post" novalidate>
        {% csrf_token %}
        <input type="hidden" name="mode" value="single">
        <fieldset>
          <label class="my-1" for="group">{% trans "Recipient's information" %}</label>
          {% render_field form.recipient_email %}
          {% render_field form.recipient_first_name %}
          {% render_field form.recipient_last_name %}
          {% render_field form.group %}
          {% render_field form.expiry_date %}

          <input type="submit" value="{% trans 'Send' %}" class="btn btn-lg btn-success btn-block">
        </fieldset>
      </form>

    {# bulk invite #}
    {% elif active_mode == 'bulk' %}
      <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        <input type="hidden" name="mode" value="bulk">
        <fieldset>
          {{ form.non_field_errors }}

          <label class="my-1">{% trans "Upload CSV file" %}</label>
          {% render_field form.file %}

          <p class="text-center"><em>{% trans "OR" %}</em></p>

          <label class="my-1">{% trans "Paste emails (one per line)" %}</label>
          {% render_field form.emails %}

          <label class="my-1" for="{{ form.group.id_for_label }}">{% trans "Team" %}</label>
          {% render_field form.group %}

          <label class="my-1" for="{{ form.expiry_date.id_for_label }}">{% trans "Expiry date (optional)" %}</label>
          {% render_field form.expiry_date %}

          <input
            type="submit"
            value="{% trans 'Send Invitations' %}"
            class="btn btn-lg btn-success btn-block"
          >
        </fieldset>
      </form>
    {% endif %}

  </div>
</div>
{% endblock %}
